@page "/shipping"
<h3>Shipping</h3>


@* order number, customer name, items list, total amount, status, and shipper. *@
                        <button class="btn btn-primary">Create Shipment</button>

<table class="table table-dark table-hover">
  <thead>
  <tr>
    <th>Order Number</th>
    <th>Customer Name</th>
    <th>Items List</th>
    <th>Shipper</th>
    <th>Status</th>
    <th>Actions</th>

  </tr>
  </thead>
  <tbody>
    @foreach (var item in LocalDb.CurrentShipments)
    {
        <tr>
            <td>@item.OrderNumber</td>
            <td>@item.CustomerName</td>
            <td>
                <table class="table table-dark table-hover">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Quantity</th>
                            <th>Price</th>
                        </tr>
                    </thead>
                    <tbody>
                    @foreach (var shipmentItem in item.ShipmentItemsList)
                    {
                        <tr>
                            <td>@shipmentItem.Name</td>
                            <td>@shipmentItem.Quantity</td>
                            <td>@shipmentItem.UnitPrice</td>
                        </tr>
                    }
                    </tbody>
                </table>
            </td>
            <td>@item.Shipper</td>
            <td>@item.Status</td>
            <td>
                <div>
                    <button class="btn btn-primary" @onclick="()=>Return(item)">Return</button>
                        <button class="btn btn-primary" @onclick="()=>Ship(item)">Ship</button>
                </div>
            </td>
        </tr>
    }

  </tbody>
</table>
@code {

    private void Ship(Shipment shipment)
    {
        LocalDb.CurrentShipments.Remove(shipment);
    }

    private void Return(Shipment shipment)
    {
        LocalDb.CurrentShipments.Remove(shipment);
        shipment.ShipmentItemsList.ForEach(
            product =>
            {
                LocalDb.AvailableProducts.First(x=>x.Name.Equals(product.Name)).Quantity += product.Quantity;
            });
    }
}